{% extends 'main/base.html' %} {% load static %} {% block content %}
{% load goods_tags %}
<div class="row">
  <!-- Форма фильтров -->
  <div class="dropdown mb-2">
    <button
      class="btn btn-secondary dropdown-toggle btn-dark"
      type="button"
      data-bs-toggle="dropdown"
      aria-expanded="false"
    >
      Фильтры
    </button>

    <form
      action="{% url 'catalog:index' slug_url %}"
      method="get"
      class="dropdown-menu bg-dark"
      data-bs-theme="dark"
    >
      <div class="form-check text-white mx-3">
        <input
          class="form-check-input"
          type="checkbox"
          name="on_sale"
          id="flexCheckDefault"
          value="on" 
          {% if request.GET.on_sale == "on" %} checked {% endif %}
        />
        {% comment %} <input type="hidden" name="q" value="request.GET.q" /> {% endcomment %}
        <label class="form-check-label" for="flexCheckDefault">
          Товары по акции
        </label>
      </div>
      <p class="text-white mx-3 mt-3">Сортировать:</p>
      <div class="form-check text-white mx-3">
        <input
          class="form-check-input"
          type="radio"
          name="order_by"
          id="flexRadioDefault1"
          value="default"
          {% if request.GET.order_by == 'default' or not request.GET.order_by %} checked {% endif %}
        />
        <label class="form-check-label" for="flexRadioDefault1">
          По умолчанию
        </label>
      </div>
      <div class="form-check text-white mx-3">
        <input
          class="form-check-input"
          type="radio"
          name="order_by"
          id="flexRadioDefault2"
          value="price"
          {% if request.GET.order_by == 'price' %} checked {% endif %}
        />
        <label class="form-check-label" for="flexRadioDefault2">
          От дешевых к дорогим
        </label>
      </div>
      <div class="form-check text-white mx-3">
        <input
          class="form-check-input"
          type="radio"
          name="order_by"
          id="flexRadioDefault3"
          value="-price"
          {% if request.GET.order_by == '-price' %} checked {% endif %}
        />
        <label class="form-check-label" for="flexRadioDefault3">
          От дорогих к дешевым
        </label>
      </div>
      <button type="submit" class="btn btn-primary mx-3 mt-3">Применить</button>
    </form>
  </div>

  {% for product in goods %}
  <div class="col-lg-4 col-md-6 p-4">
    <div class="card border-primary rounded custom-shadow">
      {% if product.image %}
      <img
        src="{{ product.image.url }}"
        class="card-img-top"
        alt="{{ product.name }}"
      />
      {% else %}
      <img
        src="{% static 'deps/images/Not found image.png' %}"
        class="card-img-top"
        alt="..."
      />
      {% endif %}
      <div class="card-body">
        <a href="{% url 'catalog:product' product.slug %}">
          <p class="card-title">{{ product.name }}</p>
        </a>
        <p class="card-text">{{ product.description|truncatechars:55 }}</p>
        <p class="product_id">Артикул: {{ product.display_id }}</p>
        <div class="d-flex justify-content-between">
          {% if product.discount %}
          <p><s>{{ product.price }} $</s></p>
          <p><strong>{{ product.sell_price }} $</strong></p>
          <p>
            <strong class="badge bg-warning text-dark"
              >Скидка {{ product.discount }} %</strong
            >
          </p>
          {% else %}
          <p><strong>{{ product.price }} $</strong></p>
          {% endif %}
          <a href="#" class="btn add-to-cart">
            <img
              class="mx-1"
              src="{% static 'deps/icons/cart-plus.svg' %}"
              alt="Catalog Icon"
              width="32"
              height="32"
            />
          </a>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
<!-- Пагинация -->
<nav aria-label="Page navigation example">
  <ul class="pagination justify-content-center">
    {% if goods.has_previous %}
    <li class="page-item">
      <a
        class="page-link"
        href="?{% change_params page=goods.previous_page_number %}"
        aria-label="Previous"
      >
        <span aria-hidden="true">&laquo;</span>
      </a>
    </li>
    {% else %}
    <li class="page-item disabled">
      <a class="page-link" href="#" aria-label="Previous">
        <span aria-hidden="true">&laquo;</span>
      </a>
    </li>
    {% endif %} {% for num in page_range %}
    {% if goods.number == num %}
    <li class="page-item active">
      <a class="page-link" href="#">{{ num }}</a>
    </li>
    {% else %}
    <li class="page-item">
      <a class="page-link" href="?{% change_params page=num %}">{{ num }}</a>
    </li>
    {% endif %} {% endfor %} {% if goods.has_next %}
    <li class="page-item">
      <a
        class="page-link"
        href="?{% change_params page=goods.next_page_number %}"
        aria-label="Next"
      >
        <span aria-hidden="true">&raquo;</span>
      </a>
    </li>
    {% else %}
    <li class="page-item disabled">
      <a class="page-link" href="#" aria-label="Next">
        <span aria-hidden="true">&raquo;</span>
      </a>
    </li>
    {% endif %}
  {% endblock %} {% block css %}{% endblock %} {% block footer %}
  <footer class="py-4 bg-dark">
    <div class="container">
      <p class="m-0 text-center text-white">
        Copyright &copy; Home Python Hub Studio 2025
      </p>
    </div>
  </footer>
  {% endblock %}
</nav>
